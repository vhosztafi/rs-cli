#!/bin/bash
# Pre-push hook to run unit tests before pushing

echo "Running unit tests before push..."
echo ""

if ! dotnet build --configuration Release --no-restore > /dev/null 2>&1; then
    echo "Building project..."
    dotnet build --configuration Release
    if [ $? -ne 0 ]; then
        echo ""
        echo "❌ Build failed. Push aborted."
        echo "Please fix build errors before pushing."
        exit 1
    fi
fi

if dotnet test --filter "FullyQualifiedName!~Integration.Tests" --no-build --configuration Release; then
    echo ""
    echo "✅ All unit tests passed!"
    exit 0
else
    echo ""
    echo "❌ Unit tests failed. Push aborted."
    echo "Please fix the failing tests before pushing."
    exit 1
fi